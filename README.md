<h2 align="center">mergebot</h2>

### Develop
#### Source tree
```text
.
├── apps
├── build
├── cmake
├── CMakeLists.txt
├── conanfile.txt
├── docs
├── include
├── LICENSE
├── misc
├── README.md
├── src
├── tests
└── third_party
```
- `apps`    the app using this library
- `build`   the intermediate files generated by build tools
- `cmake`   cmake scripts
- `CMakeLists.txt`  the project CMakeLists
- `conanfile.txt`   declaration style dependencies file used by conan
- `docs`    write some docs here
- `include` this project's public include dir
- `LICENSE` currently we use the Apache 2.0 License
- `misc`    miscellaneous scripts
- `README.md`   the file you are reading
- `src` the library src
- `tests`   write your tests here
- `third_party` AKA extern dependencies

#### Dependencies
- python >= 3.6
To support modern C++ package manager `conan`, at least python 3.6 is needed.
- conan >= 1.53
We use `conan` to manage some 3rd-party library dependencies.
- cmake
At least cmake 3.15 is needed to generate the build system.
- a set of compiler toolchain which supports C++17
    + gcc >= 7.1(don't use gcc, we need clang for a better diagnose experience)
    + clang >= 5(specifically, clang=14.0 is preferable)
    + currently we don't promise the portability to MSVC toolchains
- a build system is required to build the project. Such as `Unix Makefiles`, `Ninja`, `Visual Studio toolkits` and so forth.

#### Optional Dependencies
You will need the following dev dependencies to contribute:
- clang-format
we use `clang-format` to unify the coding style of this project.
- clang-tidy
`clang-tidy` is our linter tool.

#### Howto
1. install conan
First, we recommend that you utilize `conan` to install project dependencies.
`Conan` can be installed on a host that has at least python 3.6 installed by executing `pip install conan`. Alternatively, if your host has a native package manager, you could also use it to install `conan`. Moreover, the more recent version of `conan` you install, the better. So be cautious if some `conan` installed through your system's package manager is at a very outdated version.
After installing `conan`, you must supply a default profile for it and alter the compiler ABI settings to stdc++11. You may accomplish this by using the following commands:
```shell
conan profile new default --detect
conan profile update settings.compiler.libcxx=libstdc++11 default
```
---
UPDATE:
we suggest using clang to compile our project in development phase, as it can
provide a better diagnostic experience:
Just touch a profile named `clang` in your conan's profile directory, enter the
following content:
```yaml
[settings]
  compiler=clang
  compiler.version=14
  compiler.libcxx=libstdc++11

[buildenv]
CC=/usr/bin/clang
CXX=/usr/bin/clang++

[runenv]
CC=/usr/bin/gcc
CXX=/usr/bin/g++
```

---

2. configure cmake
AYMK, before cmake's generation step, a configure step is required.
```shell
cmake -Bbuild
```
Of course you can generate `.ninja` files for Ninja build system by appending `-GNinja` to the above command.

3. generate
```shell
cmake --build build
```
